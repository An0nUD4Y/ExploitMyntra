from os import system, path
import random
from time import sleep
#SCRIPT WRITTEN BY ANONUD4Y, ONLY FOR TESTING PURPOSE.
r3 = str(random.randint(10,20))
r4 = str(random.randint(901,950))
def create_account():
	print
	r1 = str(random.randint(100,850))
	r2 = str(random.randint(10,90))
	Email = ("itsudy"+r1+r2+"@gmail.com")
	Password = ("Im#@udy@#"+r1+r2)
	Phone = ("91"+r2+"5"+r1+r2)
	curl_data1 = str('''{"email":''')
	curl_data2 = str('}')
	curl_request = str('''curl -i -d '{3}"{0}","password":"{1}","mobile":"{2}","gender":"male","captcha":"null","action":"signup","usertype":"C"{4}'  -H 'Content-Type: application/json' -A 'Mozilla/5.0 (X11; Linux x86_64; rv:65.0) Gecko/20100101 Firefox/65.0' -H 'Accept: application/json' -b " _d_id=e60c2e32-4b27-47f9-9692-340773fae6df; xbu={5}; xtp=1,{5},{6};"  https://www.myntra.com/web/auth/v1/signup -o Response.txt '''.format(Email, Password, Phone, curl_data1, curl_data2, r3, r4))
	print("[.] Trying To Create a Random Myntra Account with Below Details...\n")
	print("[.] Email: "+Email)
	print("[.] Password: "+Password)
	print("[.] Phone: "+Phone)
	print('[*] Sending Request To Create Temporary Account')
	sleep(4)
	system(curl_request + '> /dev/null')
	sleep(4)
	check_response_file()

def check_response_file():
	if path.isfile('Response.txt') == False:
		print('[*] Failed To Create Temporary Account..')
		print('[*] Trying Again ...')
		create_account()
	else:
		print("[*] Temporary Account Successfully Created")
		sleep(2)
		check_response_status()

def check_response_status():
	with open('Response.txt') as f:
		read_data = f.read()
		if 'HTTP/2 200'	in read_data or 'HTTP/1.1 200' in read_data:
			check_response()
		else:
			print('[*] Unknown Status Code Returned From Server..')
			print('[*] Retrying To Create Another Temporary Account...')
			sleep(6)
			create_account()
			

def check_response():
	print('[*] Editing Response File of Temporary Account...')
	system("cat Response.txt | grep  'at=..............................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................==;' -oh > data1.txt")
	system("cat Response.txt | grep  'xid=....................................;' -oh > data2.txt")
	refer_voucher_earn()

def refer_voucher_earn():
	if path.isfile('refercode.txt') == False:
		print('[!] Please Get Your Refer Code From Shout & Earn Option in Myntra App')
		print('')
		refercode = input("[.] Enter Your Myntra Shout&Earn Refer Code: ")
		print("[.] Is This Your Refer Code, Check It Twice:", refercode)
		input("\n Press Enter To Continue..")
		system('touch refercode.txt')
		with open('refercode.txt', 'r') as f:
			refercode1 = f.read().strip()
			c = refercode1.replace('', refercode)
			f = open('refercode.txt', 'w')
			f.write(c)
			f.close()
	else:
		pass

	with open('refercode.txt', 'r') as f:
		refercode = f.read().strip()
	with open('data1.txt', 'r') as f1:
		data1 = f1.read().strip()
	with open('data2.txt', 'r') as f2:
		data2 = f2.read().strip()

	curl_request2 = ('''curl -i https://www.myntra.com/proxy-pr/shoutandearn/v1/user/shoutearn/refer/{0} -b '{3}_d_id=e60c2e32-4b27-47f9-9692-340773fae6df;{4}xbu={1};xtp=1,{1},{2};' -o Response1.txt '''.format(refercode, r3, r4, data1, data2))
	sleep(4)
	system(curl_request2 + '> /dev/null')
	sleep(4)
	check_response_file2()

def check_response_file2():
	if path.isfile('Response1.txt') == False:
		print('[*] Failed To Validate Refer Code.')
		print('[*] Trying Again ...')
		refer_voucher_earn()
	else:
		check_response2()

def check_response2():
	with open('Response1.txt') as f:
		read_data = f.read()
		if 'transactionId' in read_data or 'already claimed' in read_data:
			print("\n[*] Hola , You Have Successfully Earned Refer Money , Check Your Myntra App.")
			sleep(4)
			print("\n[*] Don't Forget To Say Thanks To an0nud4y ( https://linktr.ee/its_udy)")
			sleep(6)
			print('[*] Now Complete Process Can Be Automated Just Hit Enter..')
			input("[!] Press Enter To Earn Upto 500 Rs in Myntra Account...")
			create_account()
		else:
			print('[*] Error During Refer Code Validating..')
			sleep(1)
			print('[*] Please Verify Your Refer Code And Try Again..')
			sleep(1)
			print('[*] Going Back..')
			sleep(4)
			refer_voucher_earn()
